<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SuS Clan ‚Äì XP Tracker</title>
  <style>
    :root{ --bg:#0b1020; --panel:#121a32; --muted:#8aa0c7; --text:#e8eefc; --accent:#ff9800; --accent-2:#ffc107; --border: #243054; --ok:#2ecc71; }
    *{box-sizing:border-box}
    body{ margin:0; background:linear-gradient(180deg,#0a0f1f,#0a0f1f 60%, #0e1530); color:var(--text); font: 14px/1.5 system-ui, sans-serif; min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px; }
    .wrap{ width:min(1100px, 100%); display:grid; gap:16px; }
    .card{ background:var(--panel); border:1px solid var(--border); border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.35); overflow:hidden; }
    header.card{ padding:16px 18px; display:flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;}
    .title{ font-weight:700; font-size: 1.2em; color: var(--accent); }
    button{ background:linear-gradient(45deg, var(--accent), var(--accent-2)); color:#081225; border:0; border-radius:8px; font-weight:700; padding:8px 16px; cursor:pointer; }
    button:disabled { opacity: 0.5; cursor: wait; }
    .table-wrap{ overflow:auto }
    table{ width:100%; border-collapse:separate; border-spacing:0 }
    thead th{ position:sticky; top:0; background:rgba(15,23,48,.95); text-align:left; font-weight:700; padding:12px; border-bottom:1px solid var(--border); white-space:nowrap; }
    tbody td{ padding:12px; border-bottom:1px dashed #1e2a4f; vertical-align:middle; }
    .name{ font-weight:700; color: var(--accent-2); }
    .mono{ font-family: ui-monospace, monospace; font-size: 1.1em; }
    .locked-input { background: #0a0f1f; border: 1px solid var(--border); color: var(--muted); padding: 5px 10px; border-radius: 6px; width: 130px; text-align: right; font-family: monospace; }
    .plus { color: var(--ok); font-weight: bold; }
    .neutral { color: var(--muted); }
    .center{ text-align:center; padding:24px }
    .hidden{ display:none !important }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="card">
      <div class="title">üõ°Ô∏è SuS Clan XP Tracker</div>
      <button id="btnReload">C·∫≠p nh·∫≠t d·ªØ li·ªáu</button>
    </header>
    <section class="card table-wrap">
      <div class="center" id="loading">ƒêang k·∫øt n·ªëi...</div>
      <table id="table" class="hidden">
        <thead>
          <tr><th>#</th><th>Th√†nh Vi√™n</th><th>Current XP</th><th>Locked XP</th><th>Gained XP</th></tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </section>
  </div>

 <script>
    const CLAN_DATA = [
        { name: "SuS TraDaVN", start: 45361534920 }, { name: "SuS Zet DiY", start: 39084720587 }, { name: "SuS Dominate", start: 38450414228 },
        { name: "SuS QuangTong", start: 35569912243 }, { name: "SuS t autumn t", start: 26753499820 }, { name: "SuS Karma", start: 32822171477 },
        { name: "SuS tienma", start: 18232356437 }, { name: "SuS Daedra", start: 11805772350 }, { name: "SuS GuarDian", start: 16929364157 },
        { name: "SuS Yoshe DiY", start: 6342424017 }, { name: "SuS Nightly", start: 7313042667 }, { name: "SuS Hung buda", start: 4883952202 },
        { name: "SuS Axolotl", start: 8345765571 }, { name: "SuS D3fault", start: 4009205331 }, { name: "SuS Skill", start: 5604750109 },
        { name: "SuS Merlon", start: 4349818322 }, { name: "SuS MicaelQuan", start: 4788178973 }, { name: "SuS Eupto", start: 3066982450 },
        { name: "SuS UnknownX", start: 3942788125 }, { name: "SuS Bobross", start: 5216233384 }, { name: "SuS HibikiVN", start: 1586069982 },
        { name: "SuS Zeta", start: 1772622138 }, { name: "SuS HuyKhoi VN", start: 4251076795 }, { name: "SuS Maxmillnos", start: 2251216584 },
        { name: "SuS J97 Bo Con", start: 2622015974 }, { name: "SuS Bun Cha VN", start: 1724494062 }, { name: "SuS GoG1t0", start: 2363285870 },
        { name: "SuS Naow", start: 2699422340 }, { name: "SuS DuyKhanh", start: 2629377805 }, { name: "SuS VuSua VN", start: 1712168220 },
        { name: "SuS SHIELDHERO", start: 1311790623 }, { name: "SuS lucky", start: 2680717114 }, { name: "SuS Uruneeshi", start: 1496485944 },
        { name: "SuS NoSlackSky", start: 1600803318 }, { name: "SuS mehdipro", start: 1719139440 }, { name: "SuS TraDao VN", start: 1678100063 },
        { name: "SuS SadSaiki", start: 719832247 }
    ];

    const els = { btn: document.getElementById('btnReload'), load: document.getElementById('loading'), table: document.getElementById('table'), tbody: document.getElementById('tbody') };
    const fmt = n => Number(n).toLocaleString('en-US');
    const getLock = n => parseInt(localStorage.getItem(`locked_${n}`)) || null;

    function render(){
        els.tbody.innerHTML = '';
        const sorted = [...CLAN_DATA].sort((a,b) => ((b.curr||0) - (getLock(b.name)||b.start)) - ((a.curr||0) - (getLock(a.name)||a.start)));
        sorted.forEach((r,i) => {
            const lock = getLock(r.name) || r.start;
            const cur = r.curr || r.start; 
            const gain = cur - lock;
            els.tbody.innerHTML += `<tr>
                <td class="muted">${i+1}</td><td class="name">${r.name} ${r.curr?'‚úÖ':'‚è≥'}</td><td class="mono" style="color:#fff">${fmt(cur)}</td>
                <td><input type="number" class="locked-input" value="${lock}" onchange="localStorage.setItem('locked_${r.name}',this.value);render()" onclick="this.select()"></td>
                <td class="mono ${gain>0?'plus':'neutral'}">${gain>0?'+':''}${fmt(gain)}</td>
            </tr>`;
        });
    }

    async function fetchAll(){
        els.load.classList.remove('hidden'); els.table.classList.remove('hidden'); els.btn.disabled=true; render();
        // CHIA NH·ªé: M·ªói l·∫ßn t·∫£i 5 ng∆∞·ªùi
        for(let i=0; i<CLAN_DATA.length; i+=5){
            const group = CLAN_DATA.slice(i, i+5).map(m=>encodeURIComponent(m.name)).join(',');
            els.load.innerText = `ƒêang t·∫£i nh√≥m ${Math.ceil(i/5)+1}...`;
            try {
                const res = await fetch(`https://curse-api.vercel.app/api/track?users=${group}`);
                (await res.json()).forEach(d => { const m=CLAN_DATA.find(x=>x.name===d.name); if(m) m.curr=d.xp; });
                render();
            } catch(e){ console.log(e); }
        }
        els.load.classList.add('hidden'); els.btn.disabled=false; els.btn.innerText="C·∫≠p nh·∫≠t d·ªØ li·ªáu";
    }

    els.btn.onclick = fetchAll;
    fetchAll();
  </script>
</body>
</html>
